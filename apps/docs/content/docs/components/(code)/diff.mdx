---
title: Diff
description: Displays code diffs with syntax highlighting, line numbers, and copy functionality.
path: elements/components/diff
---

The `Diff` component displays code diffs with syntax highlighting, line numbers, and copy functionality. It supports both file comparison and patch modes.

<Preview path="diff" />

## Installation

<ElementsInstaller path="diff" />

## Usage with AI SDK

Build a code editing tool that shows diffs using the [`useChat`](https://ai-sdk.dev/docs/reference/ai-sdk-ui/use-chat) hook with tool calls.

Add the following component to your frontend:

```tsx title="app/page.tsx"
'use client';

import { useChat } from '@ai-sdk/react';
import {
  Diff,
  DiffHeader,
  DiffTitle,
  DiffStats,
  DiffActions,
  DiffCopyButton,
  DiffContent,
} from '@/components/ai-elements/diff';

export default function Page() {
  const { messages } = useChat({
    api: '/api/edit',
  });

  return (
    <div className="max-w-4xl mx-auto p-6">
      {messages.map((message) => {
        const toolInvocations = message.parts?.filter(
          (part) => part.type === 'tool-invocation'
        );

        return toolInvocations?.map((tool) => {
          if (tool.toolName === 'editFile' && tool.result) {
            return (
              <Diff
                key={tool.toolCallId}
                mode="files"
                oldFile={{
                  name: tool.result.filename,
                  content: tool.result.oldContent,
                }}
                newFile={{
                  name: tool.result.filename,
                  content: tool.result.newContent,
                }}
              >
                <DiffHeader>
                  <div className="flex items-center gap-2">
                    <DiffTitle />
                    <DiffStats />
                  </div>
                  <DiffActions>
                    <DiffCopyButton copyTarget="new" />
                  </DiffActions>
                </DiffHeader>
                <DiffContent />
              </Diff>
            );
          }
          return null;
        });
      })}
    </div>
  );
}
```

Add the following route to your backend:

```tsx title="api/edit/route.ts"
import { streamText, tool } from 'ai';
import { z } from 'zod';

export async function POST(req: Request) {
  const { messages } = await req.json();

  const result = streamText({
    model: 'openai/gpt-4o',
    messages,
    tools: {
      editFile: tool({
        description: 'Edit a file and return the diff',
        parameters: z.object({
          filename: z.string(),
          oldContent: z.string(),
          newContent: z.string(),
        }),
        execute: async ({ filename, oldContent, newContent }) => {
          return { filename, oldContent, newContent };
        },
      }),
    },
  });

  return result.toDataStreamResponse();
}
```

## Features

- Syntax highlighting via @pierre/diffs (built on Shiki)
- Line numbers (optional)
- Copy to clipboard (new file, old file, or patch)
- Automatic light/dark theme switching
- File comparison and patch modes
- Composable subcomponents

## Examples

### Patch Mode

Use patch mode to render a unified diff patch string:

```tsx
const patch = `--- a/config.ts
+++ b/config.ts
@@ -1,2 +1,3 @@
-export const debug = false;
+export const debug = true;
 export const apiUrl = "https://api.example.com";
+export const verbose = true;`;

<Diff mode="patch" patch={patch}>
  <DiffHeader>
    <DiffTitle>config.ts</DiffTitle>
    <DiffStats />
  </DiffHeader>
  <DiffContent />
</Diff>
```

### Without Header

Render just the diff content:

```tsx
<Diff mode="files" oldFile={oldFile} newFile={newFile}>
  <DiffContent showLineNumbers={false} />
</Diff>
```

### With Max Height

Constrain the diff height with scrolling:

```tsx
<Diff mode="files" oldFile={oldFile} newFile={newFile}>
  <DiffHeader>
    <DiffTitle />
    <DiffStats />
  </DiffHeader>
  <DiffContent maxHeight={300} />
</Diff>
```

## Props

### `<Diff />`

<TypeTable
  type={{
    mode: {
      description: 'The diff mode: "files" for file comparison or "patch" for unified diff.',
      type: '"files" | "patch"',
    },
    oldFile: {
      description: 'The old file contents (required when mode is "files").',
      type: '{ name: string; content: string }',
    },
    newFile: {
      description: 'The new file contents (required when mode is "files").',
      type: '{ name: string; content: string }',
    },
    patch: {
      description: 'The unified diff patch string (required when mode is "patch").',
      type: 'string',
    },
    children: {
      description: 'Child elements (DiffHeader, DiffContent, etc.).',
      type: 'React.ReactNode',
    },
    className: {
      description: 'Additional CSS classes to apply to the root container.',
      type: 'string',
    },
    '...props': {
      description: 'Any other props are spread to the root div.',
      type: 'React.HTMLAttributes<HTMLDivElement>',
    },
  }}
/>

### `<DiffHeader />`

<TypeTable
  type={{
    children: {
      description: 'Header content (typically DiffTitle, DiffStats, DiffActions).',
      type: 'React.ReactNode',
    },
    className: {
      description: 'Additional CSS classes.',
      type: 'string',
    },
    '...props': {
      description: 'Any other props are spread to the header div.',
      type: 'React.HTMLAttributes<HTMLDivElement>',
    },
  }}
/>

### `<DiffTitle />`

<TypeTable
  type={{
    children: {
      description: 'Custom title content. Defaults to the filename from context.',
      type: 'React.ReactNode',
    },
    className: {
      description: 'Additional CSS classes.',
      type: 'string',
    },
    '...props': {
      description: 'Any other props are spread to the p element.',
      type: 'React.HTMLAttributes<HTMLParagraphElement>',
    },
  }}
/>

### `<DiffStats />`

<TypeTable
  type={{
    className: {
      description: 'Additional CSS classes.',
      type: 'string',
    },
    '...props': {
      description: 'Any other props are spread to the container div.',
      type: 'React.HTMLAttributes<HTMLDivElement>',
    },
  }}
/>

### `<DiffActions />`

<TypeTable
  type={{
    children: {
      description: 'Action buttons (typically DiffCopyButton).',
      type: 'React.ReactNode',
    },
    className: {
      description: 'Additional CSS classes.',
      type: 'string',
    },
    '...props': {
      description: 'Any other props are spread to the container div.',
      type: 'React.HTMLAttributes<HTMLDivElement>',
    },
  }}
/>

### `<DiffCopyButton />`

<TypeTable
  type={{
    copyTarget: {
      description: 'Which content to copy: "new" (new file), "old" (old file), or "patch" (unified diff).',
      type: '"new" | "old" | "patch"',
      default: '"new"',
    },
    onCopy: {
      description: 'Callback fired after a successful copy.',
      type: '() => void',
    },
    onError: {
      description: 'Callback fired if copying fails.',
      type: '(error: Error) => void',
    },
    timeout: {
      description: 'How long to show the copied state (ms).',
      type: 'number',
      default: '2000',
    },
    children: {
      description: 'Custom content for the button. Defaults to copy/check icons.',
      type: 'React.ReactNode',
    },
    className: {
      description: 'Additional CSS classes.',
      type: 'string',
    },
    '...props': {
      description: 'Any other props are spread to the underlying shadcn/ui Button component.',
      type: 'React.ComponentProps<typeof Button>',
    },
  }}
/>

### `<DiffContent />`

<TypeTable
  type={{
    showLineNumbers: {
      description: 'Whether to show line numbers.',
      type: 'boolean',
      default: 'true',
    },
    maxHeight: {
      description: 'Maximum height of the diff container. Enables scrolling when content exceeds this height.',
      type: 'string | number',
    },
    className: {
      description: 'Additional CSS classes.',
      type: 'string',
    },
    '...props': {
      description: 'Any other props are spread to the container div.',
      type: 'React.HTMLAttributes<HTMLDivElement>',
    },
  }}
/>
